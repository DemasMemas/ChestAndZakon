{% extends "base.html" %}

{% block content %}
<h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à —Å–∞–π—Ç!</h1>

<section style="background: #f8f9fa; padding: 30px; margin: 30px 0; border-radius: 5px; text-align: center;">
    <h2>–ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</h2>
    <form method="GET" action="{{ url_for('search') }}" style="max-width: 500px; margin: 0 auto;">
        <div style="display: flex; gap: 10px;">
            <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–≤–æ—Å—Ç—è–º –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º..."
                   style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px;">
            <button type="submit"
                    style="padding: 12px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                üîç –ü–æ–∏—Å–∫
            </button>
        </div>
    </form>
</section>

<!-- –ë–ª–æ–∫ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏ -->
<section style="margin: 40px 0;">
    <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>
    {% set recent_news = News.query.order_by(News.created_at.desc()).limit(3).all() %}

    {% if recent_news %}
        {% for news in recent_news %}
        <div style="border: 1px solid #eee; padding: 15px; margin-bottom: 15px;">
            <h3>{{ news.title }}</h3>
            <p><small>{{ news.created_at.strftime('%d.%m.%Y') }}</small></p>
            <p>{{ news.content[:100] }}...</p>
            <a href="{{ url_for('news_detail', news_id=news.id) }}">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ</a>
        </div>
        {% endfor %}
        <p><a href="{{ url_for('news') }}">–í—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ ‚Üí</a></p>
    {% else %}
        <p>–ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π.</p>
    {% endif %}
</section>

<!-- –ë–ª–æ–∫ —Å –±–ª–∏–∂–∞–π—à–∏–º–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏ -->
<section style="margin: 40px 0;">
    <h2>–ë–ª–∏–∂–∞–π—à–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h2>
    {% set upcoming_events = Event.query.filter(Event.event_date >= now).order_by(Event.event_date.asc()).limit(3).all() %}

    {% if upcoming_events %}
        {% for event in upcoming_events %}
        <div style="border: 1px solid #eee; padding: 15px; margin-bottom: 15px;">
            <h3>{{ event.title }}</h3>
            <p><strong>{{ event.event_date.strftime('%d.%m.%Y –≤ %H:%M') }}</strong></p>
            {% if event.location %}
            <p><small>–ú–µ—Å—Ç–æ: {{ event.location }}</small></p>
            {% endif %}
            <p>{{ event.description[:100] }}...</p>
            <a href="{{ url_for('event_detail', event_id=event.id) }}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
        </div>
        {% endfor %}
        <p><a href="{{ url_for('events') }}">–í—Å–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è ‚Üí</a></p>
    {% else %}
        <p>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π.</p>
    {% endif %}
</section>
{% endblock %}